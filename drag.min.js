/*!
  * drag.js - copyright Jake Luer 2011
  * https://github.com/jakeluer/drag.js
  * MIT License
  */
!function(a){"undefined"==typeof bean&&(bean=require("bean"));var b=bean.noConflict(),c=getComputedStyle||currentStyle,d=function(){var a,b=document.createElement("div");return a="ontouchstart"in b,b=null,a}();drag=function(a){return new Drag(drag.select(a))},drag.select=function(a){return document.getElementById(a)||document.querySelectorAll(a)[0]},drag.value=function(a,b,d){if(!d)return parseFloat(c(a).getPropertyValue(b));a.style[b]=d},drag.evs=function(){return d?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"}}(),Drag=function f(a){return this instanceof f?(this.el=a,this._axis="both",this._start=[],this._dragging=[],this._end=[],this.pos={},this):new f(a)},Drag.prototype.current=function(a){return drag.value(this.el,a)},Drag.prototype.axis=function(a){if(a=="x"||a=="y"||a=="both")this._axis=a;return this},Drag.prototype.container=function(a){return this._container=drag.select(a),this},Drag.prototype.start=function(a){return a&&"function"==typeof a&&this._start.push(a),this},Drag.prototype.dragging=function(a){return a&&"function"==typeof a&&this._dragging.push(a),this},Drag.prototype.end=function(a){return a&&"function"==typeof a&&this._end.push(a),this},Drag.prototype.getPos=function(a){return this.pos={x:parseFloat(this.current("left")),y:parseFloat(this.current("top"))},a&&"function"==typeof a&&a.apply(this),this},Drag.prototype.bind=function(){var a=this;return this._eventHandler=function(c){var d=parseFloat(a.current("left")),e=parseFloat(a.current("top")),f=function(b){var f=b.clientX-c.clientX,g=b.clientY-c.clientY,h,i;h=d+f,i=e+g;if(a._container){var j=a._container;h<0?h=0:h>=0&&(maxX=drag.value(j,"padding-left")+drag.value(j,"width")+drag.value(j,"padding-right")-(drag.value(a.el,"margin-left")+drag.value(a.el,"border-left-width")+drag.value(a.el,"padding-left")+drag.value(a.el,"width")+drag.value(a.el,"padding-right")+drag.value(a.el,"border-right-width")+drag.value(a.el,"margin-right")),h>maxX&&(h=maxX)),i<0?i=0:i>=0&&(maxY=drag.value(j,"padding-top")+drag.value(j,"height")+drag.value(j,"padding-bottom")-(drag.value(a.el,"margin-top")+drag.value(a.el,"border-top-width")+drag.value(a.el,"padding-top")+drag.value(a.el,"height")+drag.value(a.el,"padding-bottom")+drag.value(a.el,"border-bottom-width")+drag.value(a.el,"margin-bottom")),i>maxY&&(i=maxY))}a._axis=="x"?drag.value(a.el,"left",h+"px"):a._axis=="y"?drag.value(a.el,"top",i+"px"):(drag.value(a.el,"left",h+"px"),drag.value(a.el,"top",i+"px")),a.getPos();for(var k in a._dragging)a._dragging[k].apply(a);b.preventDefault(),b.stopPropagation()},g=function(){b.remove(document,drag.evs.move,f),b.remove(document,drag.evs.end,h)},h=function(b){for(var c in a._end)a._end[c].apply(a);g()};for(var i in a._start)a._start[i].apply(a);b.add(document,drag.evs.move,f),b.add(document,drag.evs.end,h)},this.getPos(),b.add(this.el,drag.evs.start,this._eventHandler),this},Drag.prototype.unbind=function(){b.remove(this.el,drag.evs.start,this._eventHandler)};var e=a.drag;drag.noConflict=function(){return a.drag=e,this}(typeof module!="undefined"&&module.exports&&(module.exports=drag)),a.drag=drag}(this)